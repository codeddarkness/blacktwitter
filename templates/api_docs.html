<!-- api_docs.html -->
<!DOCTYPE html>
<html>
<head>
    <title>API Documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
</head>
<body class="container">
    <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('home') }}">Twitter Clone</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('home') }}">Home</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <h1 class="mt-4 mb-4">Twitter Clone API Documentation</h1>
    
    <div class="row">
        <div class="col-md-3">
            <div class="list-group sticky-top" style="top: 20px;">
                <a href="#auth" class="list-group-item list-group-item-action">Authentication</a>
                <a href="#tweets" class="list-group-item list-group-item-action">Tweets</a>
                <a href="#users" class="list-group-item list-group-item-action">Users</a>
                {% if current_user.is_authenticated %}
                <a href="#get-token" class="list-group-item list-group-item-action list-group-item-primary">Get Your API Token</a>
                {% endif %}
            </div>
        </div>
        
        <div class="col-md-9">
            {% if current_user.is_authenticated %}
                <div class="alert alert-info mb-4" id="get-token">
                    <h4>Get Your API Token</h4>
                    <p>You need an API token to use the Twitter Clone API. You can generate one from your security settings.</p>
                    <a href="{{ url_for('security.settings') }}" class="btn btn-primary">Go to Security Settings</a>
                </div>
            {% else %}
                <div class="alert alert-warning mb-4">
                    <h4>Authentication Required</h4>
                    <p>You need to be logged in to generate an API token. Please log in to access the API.</p>
                    <a href="{{ url_for('login') }}" class="btn btn-primary">Log In</a>
                </div>
            {% endif %}
            
            <section id="auth" class="mb-5">
                <h2>Authentication</h2>
                <p>All API requests require an API token for authentication. Include the token in your request headers:</p>
                
                <pre><code class="language-http">X-API-Token: your_api_token</code></pre>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h5>Example Request with cURL</h5>
                    </div>
                    <div class="card-body">
                        <pre><code class="language-bash">curl -X GET "http://localhost:5000/api/tweets" \
-H "X-API-Token: your_api_token"</code></pre>
                    </div>
                </div>
            </section>
            
            <section id="tweets" class="mb-5">
                <h2>Tweets</h2>
                
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5>GET /api/tweets</h5>
                    </div>
                    <div class="card-body">
                        <p>Returns a list of recent tweets.</p>
                        
                        <h6>Query Parameters</h6>
                        <ul>
                            <li><code>limit</code> - Number of tweets to return (default: 10)</li>
                            <li><code>offset</code> - Number of tweets to skip (default: 0)</li>
                        </ul>
                        
                        <h6>Example Response</h6>
                        <pre><code class="language-json">[
  {
    "id": 1,
    "content": "Hello, world!",
    "timestamp": "2023-06-01T12:34:56.789Z",
    "user": {
      "id": 1,
      "username": "johndoe"
    }
  },
  {
    "id": 2,
    "content": "This is a tweet!",
    "timestamp": "2023-06-01T12:30:00.000Z",
    "user": {
      "id": 2,
      "username": "janedoe"
    }
  }
]</code></pre>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5>GET /api/tweets/:id</h5>
                    </div>
                    <div class="card-body">
                        <p>Returns a specific tweet by ID.</p>
                        
                        <h6>Example Response</h6>
                        <pre><code class="language-json">{
  "id": 1,
  "content": "Hello, world!",
  "timestamp": "2023-06-01T12:34:56.789Z",
  "user": {
    "id": 1,
    "username": "johndoe"
  },
  "like_count": 5,
  "reply_count": 2,
  "retweet_count": 1
}</code></pre>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5>POST /api/tweets</h5>
                    </div>
                    <div class="card-body">
                        <p>Creates a new tweet.</p>
                        
                        <h6>Request Body</h6>
                        <pre><code class="language-json">{
  "content": "This is my new tweet!"
}</code></pre>
                        
                        <h6>Example Response</h6>
                        <pre><code class="language-json">{
  "message": "Tweet created!",
  "id": 123
}</code></pre>
                    </div>
                </div>
            </section>
            
            <section id="users" class="mb-5">
                <h2>Users</h2>
                
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5>GET /api/users/:username</h5>
                    </div>
                    <div class="card-body">
                        <p>Returns information about a specific user.</p>
                        
                        <h6>Example Response</h6>
                        <pre><code class="language-json">{
  "id": 1,
  "username": "johndoe",
  "bio": "Just a regular guy tweeting about stuff.",
  "profile_picture": "johndoe.jpg"
}</code></pre>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5>GET /api/users/:username/tweets</h5>
                    </div>
                    <div class="card-body">
                        <p>Returns tweets by a specific user.</p>
                        
                        <h6>Query Parameters</h6>
                        <ul>
                            <li><code>limit</code> - Number of tweets to return (default: 10)</li>
                            <li><code>offset</code> - Number of tweets to skip (default: 0)</li>
                        </ul>
                        
                        <h6>Example Response</h6>
                        <pre><code class="language-json">[
  {
    "id": 1,
    "content": "Hello, world!",
    "timestamp": "2023-06-01T12:34:56.789Z"
  },
  {
    "id": 3,
    "content": "Another tweet!",
    "timestamp": "2023-06-01T11:22:33.444Z"
  }
]</code></pre>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5>POST /api/token</h5>
                    </div>
                    <div class="card-body">
                        <p>Generate a new API token for the authenticated user.</p>
                        
                        <h6>Example Response</h6>
                        <pre><code class="language-json">{
  "token": "your_api_token_here"
}</code></pre>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('pre code').forEach(el => {
                hljs.highlightElement(el);
            });
        });
    </script>
</body>
</html>